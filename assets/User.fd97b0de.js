import{_ as k,r as h,s as B,c as N,x as j,a as i,b as c,g,h as y,w as p,k as _,F as w,j as V,e as C,d as x,o,t as b,p as D,v as A,u as F}from"./index.af53e14a.js";import{A as O,t as E}from"./api.6f9d2f33.js";import{N as I}from"./N-Button.df8eb929.js";var R="/assets/delete.9937dc78.svg";const S={name:"User",components:{NButton:I,DeleteIcon:R},beforeRouteUpdate(){this.fetchUser()},emits:["delete"],setup(){const m=F(),n=O.Users(),r=h(),e=B({}),u=h(!1),f=h(!1),d=async()=>{u.value=!0;let t={};try{const a=m.params.uid,U=await n.fetchUser(a);t=U.data,r.value=U.data}catch(a){console.error(a)}finally{u.value=!1}Object.keys(t).filter(a=>!["_id","createdAt","updatedAt","createdBy"].includes(a)).forEach(a=>{e[a]=t[a]}),"role"in e||(e.role=null)},l=N(()=>Object.keys(e).find(t=>{var a;return((a=r.value)==null?void 0:a[t])!=e[t]})),s=async()=>{if(!!l.value)try{f.value=!0,await n.updateUser(r.value._id,e),await d(),E("Updated User")}catch(t){console.error(t)}finally{f.value=!1}},v=()=>{Object.keys(e).forEach(t=>{e[t]=r.value[t]})};return j(()=>{d()}),{api:n,fetchUser:d,user:r,form:e,formChanged:l,resetForm:v,fetching:u,updateUser:s,loading:f}}},M={class:"User"},T={class:"card"},L={class:"header flex items-center"},q=c("span",{class:"ml-auto"},null,-1),z={key:0,class:"form"},G=["for","textContent"],H=["id","onUpdate:modelValue","disabled"],J={class:"flex gap-2 justify-end"},K={key:1,class:"skeloading"};function P(m,n,r,e,u,f){const d=x("DeleteIcon"),l=x("NButton");return o(),i("div",M,[c("div",T,[c("div",L,[g(" User "),q,e.user?(o(),y(l,{key:0,onClick:n[0]||(n[0]=s=>m.$emit("delete",e.user))},{default:p(()=>[C(d)]),_:1})):_("",!0)]),e.fetching?_("",!0):(o(),i("div",z,[(o(!0),i(w,null,V(Object.keys(e.form),s=>(o(),i("div",{key:s,class:"form-group"},[c("label",{for:s,textContent:b(s)},null,8,G),D(c("input",{id:s,"onUpdate:modelValue":v=>e.form[s]=v,disabled:e.loading,type:"text"},null,8,H),[[A,e.form[s]]])]))),128)),c("div",J,[e.formChanged?(o(),y(l,{key:0,class:"text-gray-500",onClick:e.resetForm},{default:p(()=>[g(" Reset Changes ")]),_:1},8,["onClick"])):_("",!0),C(l,{loading:e.loading,disabled:!e.formChanged,class:"primary",onClick:e.updateUser},{default:p(()=>[g(b(e.loading?"Saving":"Save"),1)]),_:1},8,["loading","disabled","onClick"])])])),e.fetching?(o(),i("div",K)):_("",!0)])])}var Y=k(S,[["render",P]]);export{Y as default};
