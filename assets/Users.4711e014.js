import{_ as v,k as y,o as i,c as n,d as s,w as _,v as p,A as x,l as C,a as c,F as D,t as M,b as m,T as V,e as h,x as f,h as w,g as j,y as B}from"./index.d25bbfa4.js";import{A as U}from"./api.0d84de39.js";import{D as T}from"./trash.7e33790f.js";import{M as A}from"./Modal.e3477c9b.js";const I={name:"NewUser",emits:["created"],setup(){const e=y().params.project;return{api:U.Users(e),project:e}},data(){return{form:{},loading:!1}},methods:{async submit(){if(!this.loading){this.loading=!0;try{const t=this.form,{data:e,status:d}=await this.api.newUser(t);this.$emit("created",e)}finally{this.loading=!1}}}}},$={class:"NewUser"},E={class:"form-group"},F=s("label",{for:"email"},"Email",-1),K={class:"form-group"},R=s("label",{for:"password"},"Password",-1),S={class:"form-group"},L=s("label",{for:"role"},"Role:",-1),P=["disabled"];function q(t,e,d,u,o,a){return i(),n("div",$,[s("div",{class:"form",onKeydown:e[4]||(e[4]=x((...r)=>a.submit&&a.submit(...r),["enter"]))},[s("div",E,[F,_(s("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=r=>o.form.email=r),name:"email",type:"email",placeholder:"enter your email address"},null,512),[[p,o.form.email]])]),s("div",K,[R,_(s("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=r=>o.form.password=r),name:"password",type:"password",placeholder:"enter a secure password"},null,512),[[p,o.form.password]])]),s("div",S,[L,_(s("input",{id:"role","onUpdate:modelValue":e[2]||(e[2]=r=>o.form.role=r),name:"role",type:"text",placeholder:"enter a user role"},null,512),[[p,o.form.role]])]),s("button",{disabled:o.loading,class:"btn",onClick:e[3]||(e[3]=(...r)=>a.submit&&a.submit(...r))},"Submit",8,P)],32)])}var z=v(I,[["render",q]]);const G={name:"Users",components:{Modal:A,NewUser:z,DeleteIcon:T},setup(){const t=y(),e=t.params.project,d=C(()=>t.params.uid);return{api:U.Users(e),uid:d}},data(){return{users:[]}},mounted(){this.fetchData()},methods:{async fetchData(){const{data:t}=await this.api.find();this.users=t},showNewUserModal(){this.$refs.modal.show()},async deleteUser(t){await this.api.deleteUser(t),await this.fetchData(),await this.$router.replace({name:"auth"})},async onCreated(t){this.$refs.modal.hide(),await this.fetchData(),await this.$router.push({name:"user",params:{uid:t._id}})}}},H={class:"Users"},J={class:"side-bar"},O=s("div",{class:"head"},"Users",-1),Q={class:"items"},W=["onClick"],X={key:0,class:"document w-full h-full relative"},Y={key:1,class:"select-document"},Z={key:0},ee={key:1,class:""};function se(t,e,d,u,o,a){const r=c("DeleteIcon"),b=c("router-link"),k=c("router-view"),g=c("NewUser"),N=c("Modal");return i(),n("div",H,[s("div",J,[O,s("button",{class:"btn btn-text btn-sm",onClick:e[0]||(e[0]=(...l)=>a.showNewUserModal&&a.showNewUserModal(...l))}," New User "),s("div",Q,[(i(!0),n(D,null,M(o.users,l=>(i(),w(b,{key:l,to:{name:"user",params:{uid:l._id}},class:"item name"},{default:h(()=>[j(B(l.email)+" ",1),s("div",{class:"drop",onClick:te=>a.deleteUser(l)},[m(r,{class:"fill-red-500 opacity-75",width:"24",height:"24"})],8,W)]),_:2},1032,["to"]))),128))])]),u.uid?(i(),n("div",X,[m(V,{name:"fade"},{default:h(()=>[(i(),w(k,{key:u.uid}))]),_:1})])):f("",!0),u.uid?f("",!0):(i(),n("div",Y,[o.users&&o.users.length?(i(),n("div",Z,"select a user first")):(i(),n("div",ee,"create a user first"))])),m(N,{ref:"modal"},{default:h(()=>[m(g,{onCreated:a.onCreated},null,8,["onCreated"])]),_:1},512)])}var ne=v(G,[["render",se]]);export{ne as default};
