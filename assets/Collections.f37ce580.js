import{M as y}from"./Modal.5044384c.js";import{A as C,t as k,S as m}from"./api.9cb1a443.js";import{D}from"./trash.a549f6e6.js";import{o as s,c as i,a as e,_ as N,b as a,h as p,e as h,B as S,w as T,v as V,d as u,g as b,t as x,F as g,z,k as d,T as I,n as A}from"./index.e2c66d80.js";import{N as M}from"./N-Button.66bfda2d.js";const v={xmlns:"http://www.w3.org/2000/svg",class:"ionicon",viewBox:"0 0 512 512"},F=e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28 86.49 402.08 70 442l39.92-16.49 272.8-272.13-24.1-24.1zm54.45-54.44-11.79 11.78 24.1 24.1 11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z"},null,-1),K=[F];function L(o,n){return s(),i("svg",v,K)}v.width="24";v.height="24";var q={render:L};const E={name:"NewCollectionModal",components:{NButton:M,Modal:y},props:{project:{type:String,required:!0}},emits:["created"],data(){return{form:{},loading:!1}},methods:{show(){this.$refs.modal.show()},async submit(){this.loading=!0;try{await C.Collections(this.project).create({name:this.form.name}),k("Created new Collection"),this.$emit("created"),this.$refs.modal.hide()}catch(o){console.error(o)}finally{this.loading=!1}}}},U={class:"NewCollection"},Y=e("label",{class:"block mb-2",for:"email"},"Collection Name",-1),$={class:"flex justify-end w-full"};function G(o,n,_,B,l,t){const f=a("NButton"),w=a("Modal");return s(),p(w,{ref:"modal","close-on-click-outside":!l.loading,"show-close":!l.loading},{default:h(()=>[e("div",U,[e("div",{class:"",onKeydown:n[1]||(n[1]=S((...r)=>t.submit&&t.submit(...r),["enter"]))},[Y,T(e("input",{id:"email","onUpdate:modelValue":n[0]||(n[0]=r=>l.form.name=r),name:"email",placeholder:"Choose a plural name"},null,512),[[V,l.form.name]]),e("div",$,[u(f,{loading:l.loading,class:"primary mt-4",onClick:t.submit},{default:h(()=>[b(x(l.loading?"Creating":"Create"),1)]),_:1},8,["loading","onClick"])])],32)])]),_:1},8,["close-on-click-outside","show-close"])}var H=N(E,[["render",G]]);const J={name:"Collections",components:{NewCollectionModal:H,NButton:M,Modal:y,DeleteIcon:D,CreateIcon:q},data(){return{form:{name:""},collections:[],fetching:!1}},computed:{project(){return this.$route.params.project},collection(){return this.$route.params.collection}},mounted(){this.fetchData()},methods:{showNewCollectionModal(){this.$refs.newCollectionModal.show()},async fetchData(){this.fetching=!0;try{const{data:o}=await C.Collections(this.project).list();this.collections=o}catch(o){console.error(o)}finally{this.fetching=!1}},async removeCollection(o){await m.fire({title:"Drop Collection "+o.name,html:"Are you sure? <br/> collection will be dropped and all document will be lost.",cancelButtonText:"cancel",customClass:{confirmButton:"danger",cancelButton:"secondary"},confirmButtonText:"Yes, Drop it",showCancelButton:!0,preConfirm:async n=>{if(n){m.showLoading(m.getConfirmButton());try{await C.Collections(this.project).delete(o.name),await this.fetchData(),await this.$router.push({name:"collections",params:{project:this.project}}),k("Deleted Collection "+o.name),m.close()}catch(_){console.error(_)}return!1}return!1}})},onNewCollectionCreated(){this.fetchData()}}},O={class:"FireStore"},P={class:"card side-bar"},Q=e("div",{class:"header"},"Collections",-1),R={class:"items"},W=["onClick"],X=e("div",{class:"item h-8 skeloading"},null,-1),Z=e("div",{class:"item h-8 skeloading"},null,-1),ee=e("div",{class:"item h-8 skeloading"},null,-1),te={key:0,class:"document w-full h-full relative"},oe={key:1,class:"select-document"},le={key:0};function ne(o,n,_,B,l,t){const f=a("DeleteIcon"),w=a("router-link"),r=a("router-view"),j=a("NewCollectionModal");return s(),i("div",O,[e("div",P,[Q,e("button",{class:"btn btn-text btn-sm",onClick:n[0]||(n[0]=(...c)=>t.showNewCollectionModal&&t.showNewCollectionModal(...c))}," New Collection "),e("div",R,[l.fetching?d("",!0):(s(!0),i(g,{key:0},z(l.collections,c=>(s(),p(w,{key:c,to:{name:"documents",params:{collection:c.name}},class:A(["item name",{selected:c.name===t.collection}])},{default:h(()=>[b(x(c.name)+" ",1),e("div",{class:"drop",onClick:se=>t.removeCollection(c)},[u(f,{class:"fill-red-500 opacity-75",width:"24",height:"24"})],8,W)]),_:2},1032,["to","class"]))),128)),l.fetching?(s(),i(g,{key:1},[X,Z,ee],64)):d("",!0)])]),t.collection?(s(),i("div",te,[u(I,{name:"fade"},{default:h(()=>[(s(),p(r,{key:t.collection}))]),_:1})])):d("",!0),t.collection?d("",!0):(s(),i("div",oe,[l.collections&&l.collections.length?(s(),i("div",le,"Select a Collection")):d("",!0)])),u(j,{ref:"newCollectionModal",project:t.project,onCreated:t.onNewCollectionCreated},null,8,["project","onCreated"])])}var me=N(J,[["render",ne]]);export{me as default};
