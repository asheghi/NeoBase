import{o as n,c as d,a as c,_ as B,m as N,r as g,D as j,p as V,x as D,b as y,h as C,e as p,k as h,F as A,z as F,d as w,g as U,t as b,w as M,v as O}from"./index.3c335428.js";import{A as E,t as I}from"./api.9e09c6a2.js";import{N as R}from"./N-Button.1e8f368b.js";const m={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},S=c("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z"},null,-1),H=[S];function T(i,l){return n(),d("svg",m,H)}m.width="24";m.height="24";m.viewBox="0 0 24 24";var z={render:T};const L={name:"User",components:{NButton:R,DeleteIcon:z},beforeRouteUpdate(){this.fetchUser()},emits:["delete"],setup(){const i=N(),l=i.params.project,u=E.Users(l),e=g(),o=j({}),f=g(!1),_=g(!1),r=async()=>{f.value=!0;let t={};try{const s=i.params.uid,x=await u.fetchUser(s);t=x.data,e.value=x.data}catch(s){console.error(s)}finally{f.value=!1}Object.keys(t).filter(s=>!["_id","createdAt","updatedAt","createdBy"].includes(s)).forEach(s=>{o[s]=t[s]}),"role"in o||(o.role=null)},a=V(()=>Object.keys(o).find(t=>{var s;return((s=e.value)==null?void 0:s[t])!=o[t]})),v=async()=>{if(!!a.value)try{_.value=!0,await u.updateUser(e.value._id,o),await r(),I("Updated User")}catch(t){console.error(t)}finally{_.value=!1}},k=()=>{Object.keys(o).forEach(t=>{o[t]=e.value[t]})};return D(()=>{r()}),{project:l,api:u,fetchUser:r,user:e,form:o,formChanged:a,resetForm:k,fetching:f,updateUser:v,loading:_}}},Z={class:"User"},q={class:"card"},G={class:"header flex items-center"},J=U(" User "),K=c("span",{class:"ml-auto"},null,-1),P={key:0,class:"form"},Q=["for","textContent"],W=["id","onUpdate:modelValue","disabled"],X={class:"flex gap-2 justify-end"},Y=U(" Reset Changes "),$={key:1,class:"skeloading"};function ee(i,l,u,e,o,f){const _=y("DeleteIcon"),r=y("NButton");return n(),d("div",Z,[c("div",q,[c("div",G,[J,K,e.user?(n(),C(r,{key:0,onClick:l[0]||(l[0]=a=>i.$emit("delete",e.user))},{default:p(()=>[w(_)]),_:1})):h("",!0)]),e.fetching?h("",!0):(n(),d("div",P,[(n(!0),d(A,null,F(Object.keys(e.form),a=>(n(),d("div",{key:a,class:"form-group"},[c("label",{for:a,textContent:b(a)},null,8,Q),M(c("input",{id:a,"onUpdate:modelValue":v=>e.form[a]=v,disabled:e.loading,type:"text"},null,8,W),[[O,e.form[a]]])]))),128)),c("div",X,[e.formChanged?(n(),C(r,{key:0,class:"text-gray-500",onClick:e.resetForm},{default:p(()=>[Y]),_:1},8,["onClick"])):h("",!0),w(r,{loading:e.loading,disabled:!e.formChanged,class:"primary",onClick:e.updateUser},{default:p(()=>[U(b(e.loading?"Saving":"Save"),1)]),_:1},8,["loading","disabled","onClick"])])])),e.fetching?(n(),d("div",$)):h("",!0)])])}var ae=B(L,[["render",ee]]);export{ae as default};
