import{M as j}from"./Modal.9a87f9fa.js";import{A as l,t as n,S as p}from"./api.2151525c.js";import{_ as w,a as m,o as i,c,d as o,F as v,t as g,x as y,b as d,e as u,g as b,y as P,A as x,w as C,v as k}from"./index.6edaa24c.js";const N={name:"ManageProjects",components:{Modal:j},data(){return{form:{name:""},projects:[],loading:!1}},mounted(){this.fetchData()},methods:{onNewProject(){this.$refs.modal.show()},async submit(){if(this.loading){console.log("already running");return}this.loading=!0;try{const{data:s,status:e}=await l.Projects.create({name:this.form.name});this.$refs.modal.hide(),this.form.name="",await this.fetchData(),n("New project created")}catch(s){console.error(s),n("Failed to create project",{text:s.response.data.msg,icon:"error"})}finally{this.loading=!1}},async fetchData(){const{data:s}=await l.Projects.list();this.projects=s},async removeProject(s){try{if(!(await p.fire({title:"Delete Project",icon:"warning",text:`Are you sure? project "${s.name}" will be wiped out!`,showCancelButton:!0,confirmButtonText:"yes, delete project",confirmButtonColor:"red",customClass:{cancelButton:"bg-green-500 text-white"}})).isConfirmed)return;const{data:f}=await l.Projects.delete(s.name);await this.fetchData(),n(`Deleted Project "${s.name}"`)}catch(e){console.error(e),n("Failed to delete project",{text:e.response.data.msg,icon:"warning"})}finally{}}}},D={class:"ManageProjects"},B=o("div",{class:"head"},[o("h1",{class:"header-text"},"Projects")],-1),M={class:"list"},V={class:"item"},A=["onClick"],F={key:0,class:"no-data"},S={class:"new-project"},T={class:"form-group"},K=o("label",{for:"email"},"Project Name",-1);function E(s,e,f,L,r,a){const h=m("router-link"),_=m("Modal");return i(),c("div",D,[B,o("div",M,[o("div",V,[o("button",{class:"btn",onClick:e[0]||(e[0]=(...t)=>a.onNewProject&&a.onNewProject(...t))},"New Project")]),(i(!0),c(v,null,g(r.projects,t=>(i(),c("div",{key:t._id,class:"item"},[d(h,{to:{name:"collections",params:{project:t.name}},class:"name"},{default:u(()=>[b(P(t.name),1)]),_:2},1032,["to"]),o("button",{class:"btn btn-danger",onClick:O=>a.removeProject(t)},"Drop",8,A)]))),128)),!r.projects||!r.projects.length?(i(),c("div",F," you have no projects. ")):y("",!0)]),d(_,{ref:"modal",onOnClose:e[4]||(e[4]=t=>r.form.name="")},{default:u(()=>[o("div",S,[o("div",{class:"form",onKeydown:e[3]||(e[3]=x((...t)=>a.submit&&a.submit(...t),["enter"]))},[o("div",T,[K,C(o("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=t=>r.form.name=t),name:"email",placeholder:"what's the name of your app?"},null,512),[[k,r.form.name]])]),o("button",{class:"btn",onClick:e[2]||(e[2]=(...t)=>a.submit&&a.submit(...t))},"Submit")],32)])]),_:1},512)])}var G=w(N,[["render",E]]);export{G as default};
