import{M as g}from"./Modal.e5bc137a.js";import{A as w,t as y,s as m}from"./api.6f9d2f33.js";import{D}from"./trash.6ae5f1e4.js";import{N as k}from"./N-Button.df8eb929.js";import{_ as N,o as s,h as p,w as _,b as e,m as T,p as V,v as I,e as u,g as b,t as M,d as i,a as c,F as v,j as A,k as d,T as F,n as S}from"./index.af53e14a.js";var j="/assets/pencil.f9e1a66b.svg";const K={name:"NewCollectionModal",components:{NButton:k,Modal:g},emits:["created"],data(){return{form:{},loading:!1}},methods:{show(){this.$refs.modal.show()},async submit(){this.loading=!0;try{await w.Collections().create({name:this.form.name}),y("Created new Collection"),this.$emit("created"),this.$refs.modal.hide()}catch(l){console.error(l)}finally{this.loading=!1}}}},L={class:"NewCollection"},z=e("label",{class:"block mb-2",for:"email"},"Collection Name",-1),E={class:"flex justify-end w-full"};function U(l,n,h,x,o,t){const f=i("NButton"),C=i("Modal");return s(),p(C,{ref:"modal","close-on-click-outside":!o.loading,"show-close":!o.loading},{default:_(()=>[e("div",L,[e("div",{class:"",onKeydown:n[1]||(n[1]=T((...r)=>t.submit&&t.submit(...r),["enter"]))},[z,V(e("input",{id:"email","onUpdate:modelValue":n[0]||(n[0]=r=>o.form.name=r),name:"email",placeholder:"Choose a plural name"},null,512),[[I,o.form.name]]),e("div",E,[u(f,{loading:o.loading,class:"primary mt-4",onClick:t.submit},{default:_(()=>[b(M(o.loading?"Creating":"Create"),1)]),_:1},8,["loading","onClick"])])],32)])]),_:1},8,["close-on-click-outside","show-close"])}var Y=N(K,[["render",U]]);const q={name:"Collections",components:{NewCollectionModal:Y,NButton:k,Modal:g,DeleteIcon:D,CreateIcon:j},data(){return{form:{name:""},collections:[],fetching:!1}},computed:{collection(){return this.$route.params.collection}},mounted(){this.fetchData()},methods:{showNewCollectionModal(){this.$refs.newCollectionModal.show()},async fetchData(){this.fetching=!0;try{const{data:l}=await w.Collections().list();this.collections=l}catch(l){console.error(l)}finally{this.fetching=!1}},async removeCollection(l){await m.fire({title:"Drop Collection "+l.name,html:"Are you sure? <br/> collection will be dropped and all document will be lost.",cancelButtonText:"cancel",customClass:{confirmButton:"danger",cancelButton:"secondary"},confirmButtonText:"Yes, Drop it",showCancelButton:!0,preConfirm:async n=>{if(n){m.showLoading(m.getConfirmButton());try{await w.Collections().delete(l.name),await this.fetchData(),await this.$router.push({name:"collections"}),y("Deleted Collection "+l.name),m.close()}catch(h){console.error(h)}return!1}return!1}})},onNewCollectionCreated(){this.fetchData()}}},G={class:"FireStore"},H={class:"card side-bar"},J=e("div",{class:"header"},"Collections",-1),O={class:"items"},P=["onClick"],Q=e("div",{class:"item h-8 skeloading"},null,-1),R=e("div",{class:"item h-8 skeloading"},null,-1),W=e("div",{class:"item h-8 skeloading"},null,-1),X={key:0,class:"document w-full h-full relative"},Z={key:1,class:"select-document"},$={key:0};function ee(l,n,h,x,o,t){const f=i("DeleteIcon"),C=i("router-link"),r=i("router-view"),B=i("NewCollectionModal");return s(),c("div",G,[e("div",H,[J,e("button",{class:"btn btn-text btn-sm",onClick:n[0]||(n[0]=(...a)=>t.showNewCollectionModal&&t.showNewCollectionModal(...a))}," New Collection "),e("div",O,[o.fetching?d("",!0):(s(!0),c(v,{key:0},A(o.collections,a=>(s(),p(C,{key:a,to:{name:"documents",params:{collection:a.name}},class:S(["item name",{selected:a.name===t.collection}])},{default:_(()=>[b(M(a.name)+" ",1),e("div",{class:"drop",onClick:oe=>t.removeCollection(a)},[u(f,{class:"fill-red-500 opacity-75",width:"24",height:"24"})],8,P)]),_:2},1032,["to","class"]))),128)),o.fetching?(s(),c(v,{key:1},[Q,R,W],64)):d("",!0)])]),t.collection?(s(),c("div",X,[u(F,{name:"fade"},{default:_(()=>[(s(),p(r,{key:t.collection}))]),_:1})])):d("",!0),t.collection?d("",!0):(s(),c("div",Z,[o.collections&&o.collections.length?(s(),c("div",$,"Select a Collection")):d("",!0)])),u(B,{ref:"newCollectionModal",onCreated:t.onNewCollectionCreated},null,8,["onCreated"])])}var ce=N(q,[["render",ee]]);export{ce as default};
