import{M as y}from"./Modal.85e7a6c6.js";import{A as w,t as k,S as m}from"./api.9e09c6a2.js";import{D as B}from"./trash.d071f0d1.js";import{o as s,c as a,a as t,_ as N,b as i,h as C,e as u,D as S,w as T,v as V,d as h,g as b,t as x,F as g,z,k as d,T as I,n as A}from"./index.cdcacdc3.js";import{N as M}from"./N-Button.ff915318.js";const v={xmlns:"http://www.w3.org/2000/svg",class:"ionicon",viewBox:"0 0 512 512"},F=t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28 86.49 402.08 70 442l39.92-16.49 272.8-272.13-24.1-24.1zm54.45-54.44-11.79 11.78 24.1 24.1 11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z"},null,-1),K=[F];function L(e,n){return s(),a("svg",v,K)}v.width="24";v.height="24";var $={render:L};const q={name:"NewCollectionModal",components:{NButton:M,Modal:y},props:{project:{type:String,required:!0}},emits:["created"],data(){return{form:{},loading:!1}},methods:{show(){this.$refs.modal.show()},async submit(){this.loading=!0;try{await w.Collections(this.project).create({name:this.form.name}),k("Created new Collection"),this.$emit("created"),this.$refs.modal.hide()}catch(e){console.error(e)}finally{this.loading=!1}}}},E={class:"NewCollection"},U=t("label",{class:"block mb-2",for:"email"},"Collection Name",-1),Y={class:"flex justify-end w-full"};function G(e,n,_,D,l,o){const f=i("NButton"),p=i("Modal");return s(),C(p,{ref:"modal","close-on-click-outside":!l.loading,"show-close":!l.loading},{default:u(()=>[t("div",E,[t("div",{class:"",onKeydown:n[1]||(n[1]=S((...r)=>o.submit&&o.submit(...r),["enter"]))},[U,T(t("input",{id:"email","onUpdate:modelValue":n[0]||(n[0]=r=>l.form.name=r),name:"email",placeholder:"Choose a plural name"},null,512),[[V,l.form.name]]),t("div",Y,[h(f,{loading:l.loading,class:"primary mt-4",onClick:o.submit},{default:u(()=>[b(x(l.loading?"Creating":"Create"),1)]),_:1},8,["loading","onClick"])])],32)])]),_:1},8,["close-on-click-outside","show-close"])}var H=N(q,[["render",G]]);const J={name:"Collections",components:{NewCollectionModal:H,NButton:M,Modal:y,DeleteIcon:B,CreateIcon:$},data(){return{form:{name:""},collections:[],fetching:!1}},computed:{project(){return this.$route.params.project},collection(){return this.$route.params.collection}},watch:{"$route.params.project":{handler(e,n){e&&this.fetchData()}}},mounted(){this.fetchData()},methods:{showNewCollectionModal(){this.$refs.newCollectionModal.show()},async fetchData(){this.fetching=!0;try{const{data:e}=await w.Collections(this.project).list();this.collections=e}catch(e){console.error(e)}finally{this.fetching=!1}},async removeCollection(e){await m.fire({title:"Drop Collection "+e.name,html:"Are you sure? <br/> collection will be dropped and all document will be lost.",cancelButtonText:"cancel",customClass:{confirmButton:"danger",cancelButton:"secondary"},confirmButtonText:"Yes, Drop it",showCancelButton:!0,preConfirm:async n=>{if(n){m.showLoading(m.getConfirmButton());try{await w.Collections(this.project).delete(e.name),await this.fetchData(),await this.$router.push({name:"collections",params:{project:this.project}}),k("Deleted Collection "+e.name),m.close()}catch(_){console.error(_)}return!1}return!1}})},onNewCollectionCreated(){this.fetchData()}}},O={class:"FireStore"},P={class:"card side-bar"},Q=t("div",{class:"header"},"Collections",-1),R={class:"items"},W=["onClick"],X=t("div",{class:"item h-8 skeloading"},null,-1),Z=t("div",{class:"item h-8 skeloading"},null,-1),ee=t("div",{class:"item h-8 skeloading"},null,-1),te={key:0,class:"document w-full h-full relative"},oe={key:1,class:"select-document"},le={key:0};function ne(e,n,_,D,l,o){const f=i("DeleteIcon"),p=i("router-link"),r=i("router-view"),j=i("NewCollectionModal");return s(),a("div",O,[t("div",P,[Q,t("button",{class:"btn btn-text btn-sm",onClick:n[0]||(n[0]=(...c)=>o.showNewCollectionModal&&o.showNewCollectionModal(...c))}," New Collection "),t("div",R,[l.fetching?d("",!0):(s(!0),a(g,{key:0},z(l.collections,c=>(s(),C(p,{key:c,to:{name:"documents",params:{collection:c.name}},class:A(["item name",{selected:c.name===o.collection}])},{default:u(()=>[b(x(c.name)+" ",1),t("div",{class:"drop",onClick:se=>o.removeCollection(c)},[h(f,{class:"fill-red-500 opacity-75",width:"24",height:"24"})],8,W)]),_:2},1032,["to","class"]))),128)),l.fetching?(s(),a(g,{key:1},[X,Z,ee],64)):d("",!0)])]),o.collection?(s(),a("div",te,[h(I,{name:"fade"},{default:u(()=>[(s(),C(r,{key:o.collection}))]),_:1})])):d("",!0),o.collection?d("",!0):(s(),a("div",oe,[l.collections&&l.collections.length?(s(),a("div",le,"Select a Collection")):d("",!0)])),h(j,{ref:"newCollectionModal",project:o.project,onCreated:o.onNewCollectionCreated},null,8,["project","onCreated"])])}var me=N(J,[["render",ne]]);export{me as default};
